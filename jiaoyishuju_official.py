# -*- coding: utf-8 -*-import urllib2from bs4 import BeautifulSoupimport xlrdimport xlwtbook = xlrd.open_workbook("lianjiadata.xls")sh = book.sheet_by_index(0)wb = xlwt.Workbook()ws = wb.add_sheet('data', cell_overwrite_ok=True)for rx in range(sh.nrows):    for lx in range(sh.ncols):        nRow = rx        nLin = lx        ws.write(nRow, nLin, sh.cell_value(rowx=nRow, colx=nLin))def download(url):    print 'Downloading:', url    try:        html = urllib2.urlopen(url).read()    except urllib2.URLError as e:        print 'Download error', e.reason        html = None    return htmlurl = 'http://www.bjjs.gov.cn/tabid/2167/default.aspx'html = download(url)soup = BeautifulSoup(html, 'html.parser')date = soup.find(    attrs={        'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_timeMark'}).textprint datews.write(0, sh.ncols, date)# 期房网上认购# print '期房网上认购'pre_net_num = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_totalCount3'}).text# print '期房网上认购套数:'# print pre_net_num# ws.write(1, 0, '期房网上认购套数:')ws.write(1, sh.ncols, float(pre_net_num))#pre_net_total_area = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_totalArea3'}).text# print '期房网上认购面积(M2)：'# print pre_net_total_area# ws.write(2, 0, '期房网上认购面积(M2)：')ws.write(2, sh.ncols, float(pre_net_total_area))pre_net_houses = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_residenceCount3'}).text# print '期房网上认购住宅套数：'# print pre_net_houses# ws.write(3, 0, '期房网上认购住宅套数：')ws.write(3, sh.ncols, float(pre_net_houses))pre_net_area = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_residenceArea3'}).text# print '期房网上认购住宅面积(M2)：'# print pre_net_area# ws.write(4, 0, '期房网上认购住宅面积(M2)：')ws.write(4, sh.ncols, float(pre_net_area))# print '----------------------------------'# 期房网上签约# print '期房网上签约'pre_sign_num = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_totalCount4'}).text# print '期房网上签约套数:'# print pre_sign_num# ws.write(5, 0,'期房网上签约套数:')ws.write(5, sh.ncols, float(pre_sign_num))pre_sign_total_area = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_totalArea4'}).text# print '期房网上签约面积(M2)：'# print pre_sign_total_area# ws.write(6, 0, '期房网上签约面积(M2)：')ws.write(6, sh.ncols, float(pre_sign_total_area))pre_sign_houses = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_residenceCount4'}).text# print '期房住宅签约套数：'# print pre_sign_houses# ws.write(7, 0, '期房住宅签约套数：')ws.write(7, sh.ncols, float(pre_sign_houses))pre_sign_area = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_residenceArea4'}).text# print '期房网上住宅签约面积(M2)：'# print pre_sign_area# ws.write(8, 0, '期房网上住宅签约面积(M2)：')ws.write(8, sh.ncols, float(pre_sign_area))# print '----------------------------------'# 现房网上认购# print '现房网上认购'now_net_num = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_totalCount7'}).text# print '现房网上认购套数:'# print now_net_num# ws.write(9, 0, '现房网上认购套数:')ws.write(9, sh.ncols, float(now_net_num))now_net_total_area = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_totalArea7'}).text# print '现房网上认购面积(M2)：'# print now_net_total_area# ws.write(10, 0, '现房网上认购面积(M2)：')ws.write(10, sh.ncols, float(now_net_total_area))now_net_houses = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_residenceCount7'}).text# print '现房网上认购住宅套数：'# print now_net_houses# ws.write(11, 0, '现房网上认购住宅套数：')ws.write(11, sh.ncols, float(now_net_houses))now_net_area = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_residenceArea7'}).text# print '现房网上认购住宅面积(M2)：'# print now_net_area# ws.write(12, 0, '现房网上认购住宅面积(M2)：')ws.write(12, sh.ncols, float(now_net_area))# print '----------------------------------'# 现房网上签约# print '现房网上签约'now_sign_num = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_totalCount8'}).text# print '现房网上签约套数:'# print now_sign_num# ws.write(13, 0, '现房网上签约套数:')ws.write(13, sh.ncols, float(now_sign_num))now_sign_total_area = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_totalArea8'}).text# print '现房网上签约面积(M2)：'# print now_sign_total_area# ws.write(14, 0, '现房网上签约面积(M2)：')ws.write(14, sh.ncols, float(now_sign_total_area))now_sign_houses = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_residenceCount8'}).text# print '现房网上住宅签约套数：'# print now_sign_houses# ws.write(15, 0, '现房网上住宅签约套数：')ws.write(15, sh.ncols, float(now_sign_houses))now_sign_area = soup.find(    attrs={'id': 'ess_ctr5115_FDCJY_HouseTransactionStatist_residenceArea8'}).text# print '现房网上签约面积(M2)：'# print now_sign_area# ws.write(16, 0, '现房网上签约面积(M2)：')ws.write(16, sh.ncols, float(now_sign_area))# print '----------------------------------'left_sign_num = soup.find(    attrs={'id': 'ess_ctr5112_FDCJY_SignOnlineStatistics_totalCount4'}).textws.write(18, sh.ncols, float(left_sign_num))left_sign_total_area = soup.find(    attrs={'id': 'ess_ctr5112_FDCJY_SignOnlineStatistics_totalArea4'}).textws.write(19, sh.ncols, float(left_sign_total_area))left_sign_houses = soup.find(    attrs={'id': 'ess_ctr5112_FDCJY_SignOnlineStatistics_residenceCount4'}).textws.write(20, sh.ncols, float(left_sign_houses))left_sign_area = soup.find(    attrs={'id': 'ess_ctr5112_FDCJY_SignOnlineStatistics_residenceArea4'}).textws.write(21, sh.ncols, float(left_sign_area))# print '----------------------------------'left_new_num = soup.find(    attrs={'id': 'ess_ctr5112_FDCJY_SignOnlineStatistics_totalCount2'}).textws.write(23, sh.ncols, float(left_new_num))left_new_total_area = soup.find(    attrs={'id': 'ess_ctr5112_FDCJY_SignOnlineStatistics_totalArea2'}).textws.write(24, sh.ncols, float(left_new_total_area))left_new_houses = soup.find(    attrs={'id': 'ess_ctr5112_FDCJY_SignOnlineStatistics_residenceCount2'}).textws.write(25, sh.ncols, float(left_new_houses))left_new_area = soup.find(    attrs={'id': 'ess_ctr5112_FDCJY_SignOnlineStatistics_residenceArea2'}).textws.write(26, sh.ncols, float(left_new_area))wb.save('lianjiadata.xls')